# Masa Framework源码解读-缓存设计（分布式缓存进阶之多级缓存）

## 序言

​		今天这篇文章来看看Masa Framework的缓存设计，上一篇文章中说到的MasaFactory的应用也会在这章节出现。文章中如有错误之处还请指点，咱们话不多说，直入主题。

## Masa Framework缓存简介

> MASA Framework源码地址：https://github.com/masastack/MASA.Framework

​		Masa Framework中的缓存组件支持 **```分布式缓存```** 和 **```分布式多级缓存```** （PS：Masa Framework的缓存组件并不与框架强行绑定，也就是说我们可以只使用masa framework的缓存组件，而不是我必须用masa framework才能使用它的缓存组件，这一点必须给官方点个大大的赞)。首先分布式缓存大家多多少少都听说过也用过，在这不多介绍分布式缓存的概念。我们来看下多级缓存吧，其实多级缓存这个概念很早就有，但是在.net中没怎么看到这个设计的落地实现框架，今天刚好借着源码解读，我们一起来看看masa framework的多级缓存设计。

## 多级缓存的定义

> 什么是多级缓存？既然已经有了分布式缓存，为什么还要多级缓存？

​		首先什么是多级缓存？多级缓存是指在一个系统的不同架构层级进行数据缓存，以提升访问效率。其次有了分布式缓存，为什么还要多级缓存？是因为在读取数据频率很高的情况下，分布式缓存面临着两个问题：响应速度和高可用。响应速度问题是指数据读取和网络请求问题，数据读取这个一般没啥问题，而网络请求的不确定性以及耗时时长是不可避免的。而高可用问题是指大量读取数据请求过来读取缓存的时候，分布式缓存能否扛得住这么大的压力，当然这个有解决方案可以使用集群解决，但是一旦集群数据的同步及时性和网络问题将会扩大。

​		而多级缓存就是为了解决分布式缓存存在的一些问题，而衍生另一种手段。所谓多级缓存可以简单理解为是通过在分布式缓存和我们的访问层中间在增加一层缓存来减少对分布式缓存的网络请求以及分布式缓存的压力。

![multilevel_cache_](images\multilevel_cache\multilevel_cache.png)

## MASA Framework中的多级缓存设计





## 源码设计

1. 首先第一步，我们把源码下载下来，然后打开。masa framework缓存组件分为两部分，一个是BuildingBlocks下的Caching抽象接口，另外一个是Contrib下的Caching接口实现

   ![](./images/multilevel_cache/source_struct.png)
   
   

## Demo案例





## 总结

